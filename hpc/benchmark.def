Bootstrap: docker
From: ubuntu:18.04

%help
    App: benchmark
    Usage: singulaity exec <image name> bench

%files
    ./bench
    ./sources.list

%post
    mv -f sources.list /etc/apt
    apt-get update && apt-get install -y mesa-opencl-icd ocl-icd-opencl-dev
    rm -rf /var/lib/apt/lists/*

    mv bench /usr/local/bin

%environment
    export LC_ALL=C
    # export TRUST_PARAMS=1
    export RUST_LOG=info
    export FIL_PROOFS_MAXIMIZE_CACHING=1
    # export FIL_PROOFS_USE_GPU_COLUMN_BUILDER=1
    export FIL_PROOFS_PARAMETER_CACHE=proofs